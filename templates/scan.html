{% extends "base.html" %}

{% block title %}Scan - Web Vulnerability Scanner{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h2 class="mb-0"><i class="bi bi-search"></i> Start Vulnerability Scan</h2>
            </div>
            <div class="card-body">
                <form method="POST" action="{{ url_for('scan') }}" id="scanForm">
                    <div class="mb-3">
                        <label for="target_url" class="form-label">
                            <strong>Target URL</strong>
                        </label>
                        <input 
                            type="url" 
                            class="form-control form-control-lg" 
                            id="target_url" 
                            name="target_url" 
                            placeholder="http://example.com/page?id=1"
                            required
                            autofocus
                        >
                        <div class="form-text">
                            Enter the full URL including query parameters (e.g., <code>http://localhost/dvwa/vulnerabilities/sqli/?id=1</code>)
                        </div>
                    </div>

                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i> <strong>Scanning Process:</strong>
                        <ul class="mb-0 mt-2">
                            <li>SQL Injection detection (error-based)</li>
                            <li>Reflected XSS detection</li>
                            <li>Results will be saved to database</li>
                            <li>Reports can be downloaded after scan completes</li>
                        </ul>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary btn-lg" id="scanBtn">
                            <i class="bi bi-play-circle"></i> Start Scan
                        </button>
                    </div>
                </form>
            </div>
        </div>

    </div>
</div>

{% block extra_js %}
<script>
    document.getElementById('scanForm').addEventListener('submit', function(e) {
        const btn = document.getElementById('scanBtn');
        btn.disabled = true;
        btn.innerHTML = '<span class="spinner-border spinner-border-sm" role="status"></span> Scanning...';
    });
</script>
{% endblock %}
{% endblock %}

